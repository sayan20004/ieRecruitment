@{
    ViewData["Title"] = "Application Submitted";
    Layout = "~/Views/Shared/_LayoutRecruitment.cshtml";
}

@section Styles {
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        @@font-face {
            font-family: 'Manrope';
            src: url('/fonts/Manrope-Medium.woff2') format('woff2'),
                 url('/fonts/Manrope-Medium.woff') format('woff');
            font-weight: 500; font-style: normal; font-display: swap;
        }

        :root { --primary: #003b5b; --accent: #0461A3; --success: #16a34a; }
        *, *::before, *::after { box-sizing: border-box; }
        html, body {
            height: 100%; margin: 0;
            font-family: 'Manrope', system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #f0f4f8 0%, #e2ecf5 50%, #f8f9fa 100%);
        }

        .page-wrap {
            min-height: 100vh; display: flex; flex-direction: column;
        }

        .sc-body {
            overflow-y: auto;
        }

        /* Header */
        .sc-header {
            padding: 14px 24px; display: flex; align-items: center; gap: 12px;
            border-bottom: 1px solid #e9ecef; background: #fff;
        }
        .sc-header img { max-height: 36px; }
        .sc-header h2 {
            margin: 0; font-size: 1rem; font-weight: 600; letter-spacing: 1px;
            color: var(--primary);
        }

        /* Center content */
        .sc-body {
            flex: 1; display: flex; align-items: center; justify-content: center;
            padding: 24px;
        }

        .sc-card {
            background: #fff; border: 1px solid #d9e3f0; border-radius: 16px;
            box-shadow: 0 8px 40px rgba(0, 59, 91, .08);
            max-width: 580px; width: 100%; padding: 48px 40px; text-align: center;
            animation: fadeUp .6s ease-out both;
        }

        @@keyframes fadeUp {
            from { opacity: 0; transform: translateY(30px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* Animated checkmark */
        .check-ring {
            width: 96px; height: 96px; border-radius: 50%;
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto 28px;
            animation: popIn .5s .2s ease-out both;
        }
        @@keyframes popIn {
            0%   { transform: scale(0); opacity: 0; }
            60%  { transform: scale(1.15); }
            100% { transform: scale(1); opacity: 1; }
        }

        .check-ring svg {
            width: 48px; height: 48px;
        }
        .check-path {
            stroke: var(--success); stroke-width: 3; fill: none;
            stroke-linecap: round; stroke-linejoin: round;
            stroke-dasharray: 48; stroke-dashoffset: 48;
            animation: drawCheck .5s .55s ease-out forwards;
        }
        @@keyframes drawCheck {
            to { stroke-dashoffset: 0; }
        }

        .sc-card h3 {
            font-size: 1.5rem; font-weight: 700; color: var(--primary);
            margin-bottom: 8px;
        }
        .sc-card .sc-subtitle {
            font-size: .95rem; color: #475569; margin-bottom: 24px; line-height: 1.6;
        }

        /* Info pills */
        .sc-info {
            background: #f1f5f9; border-radius: 12px; padding: 20px 24px;
            margin-bottom: 28px; text-align: left;
        }
        .sc-info-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 6px 0; font-size: .85rem;
        }
        .sc-info-row + .sc-info-row { border-top: 1px solid #e2e8f0; }
        .sc-info-label { color: #64748b; font-weight: 500; }
        .sc-info-value { color: var(--primary); font-weight: 600; }

        /* Timeline steps */
        .sc-next-steps {
            text-align: left; margin-bottom: 28px;
        }
        .sc-next-steps h6 {
            font-size: .85rem; font-weight: 700; color: var(--primary);
            margin-bottom: 12px; text-transform: uppercase; letter-spacing: .5px;
        }
        .sc-step {
            display: flex; gap: 12px; align-items: flex-start; margin-bottom: 10px;
        }
        .sc-step-icon {
            width: 28px; height: 28px; min-width: 28px; border-radius: 50%;
            background: #eff6ff; color: var(--accent); font-size: .75rem;
            font-weight: 700; display: flex; align-items: center; justify-content: center;
        }
        .sc-step-text {
            font-size: .84rem; color: #475569; line-height: 1.5; padding-top: 3px;
        }

        /* Buttons */
        .sc-actions { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
        .sc-btn {
            padding: 10px 28px; border-radius: 8px; font-size: .85rem; font-weight: 600;
            text-decoration: none; display: inline-flex; align-items: center; gap: 8px;
            transition: all .2s ease; cursor: pointer; border: none;
        }
        .sc-btn-primary {
            background: var(--primary); color: #fff;
        }
        .sc-btn-primary:hover { background: #00506e; color: #fff; }
        .sc-btn-outline {
            background: #fff; color: var(--primary); border: 1.5px solid #d1d9e6;
        }
        .sc-btn-outline:hover { border-color: var(--primary); background: #f8fbff; color: var(--primary); }

        /* Footer */
        .sc-footer {
            padding: 12px 24px; text-align: center; font-size: .78rem; color: #94a3b8;
            border-top: 1px solid #e9ecef; background: #fff;
        }

        /* Confetti canvas */
        #confetti-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
        }

        /* Responsive */
        @@media (max-width: 576px) {
            .sc-card { padding: 32px 20px; }
            .sc-card h3 { font-size: 1.25rem; }
            .check-ring { width: 76px; height: 76px; }
            .check-ring svg { width: 38px; height: 38px; }
            .sc-info { padding: 14px 16px; }
            .sc-actions { flex-direction: column; }
            .sc-btn { width: 100%; justify-content: center; }
        }
    </style>
}

<canvas id="confetti-canvas"></canvas>

<div class="page-wrap">
    <!-- Header -->
    <div class="sc-header">
        <img src="~/img/logo1.png" alt="Mendine Logo" onerror="this.style.display='none'">
        <h2>RECRUITMENT PORTAL</h2>
    </div>

    <!-- Main Content -->
    <div class="sc-body">
        <div class="sc-card">
            <!-- Animated Check -->
            <div class="check-ring">
                <svg viewBox="0 0 48 48">
                    <path class="check-path" d="M12 24 L21 33 L36 15" />
                </svg>
            </div>

            <h3>Application Submitted!</h3>
            <p class="sc-subtitle">
                Thank you for completing your recruitment application.<br>
                Your details have been successfully recorded.
            </p>

            <!-- Submission Info -->
            <div class="sc-info">
                <div class="sc-info-row">
                    <span class="sc-info-label">Candidate Code</span>
                    <span class="sc-info-value" id="candidateCode">—</span>
                </div>
                <div class="sc-info-row">
                    <span class="sc-info-label">Submitted On</span>
                    <span class="sc-info-value" id="submittedDate">—</span>
                </div>
                <div class="sc-info-row">
                    <span class="sc-info-label">Status</span>
                    <span class="sc-info-value">
                        <span style="background:#dcfce7;color:#16a34a;padding:2px 10px;border-radius:20px;font-size:.78rem;">
                            <i class="bi bi-check-circle-fill me-1"></i>Received
                        </span>
                    </span>
                </div>
            </div>

            <!-- Next Steps -->
            <div class="sc-next-steps">
                <h6><i class="bi bi-signpost-split me-1"></i> What Happens Next?</h6>
                <div class="sc-step">
                    <div class="sc-step-icon">1</div>
                    <div class="sc-step-text">Our HR team will review your application within <strong>3–5 business days</strong>.</div>
                </div>
                <div class="sc-step">
                    <div class="sc-step-icon">2</div>
                    <div class="sc-step-text">You will receive an email with further instructions or an interview schedule.</div>
                </div>
                <div class="sc-step">
                    <div class="sc-step-icon">3</div>
                    <div class="sc-step-text">For any queries, contact us at <strong>hr&#64;mendine.com</strong>.</div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="sc-actions">
                <a href="/Dashboard" class="sc-btn sc-btn-primary">
                    <i class="bi bi-grid-1x2"></i> Go to Dashboard
                </a>
                <a href="/" class="sc-btn sc-btn-outline">
                    <i class="bi bi-house-door"></i> Back to Home
                </a>
                <button class="sc-btn sc-btn-outline" onclick="window.print()">
                    <i class="bi bi-printer"></i> Print Confirmation
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="sc-footer">
        &copy; @DateTime.Now.Year Mendine Technologies Pvt Ltd. All rights reserved.
    </div>
</div>

@section Scripts {
    <script>
        // Fill submission info
        (function () {
            // Candidate code from localStorage or default
            const code = localStorage.getItem('candidateCode') || 'MEN-2026-XXXX';
            document.getElementById('candidateCode').textContent = code;

            // Submission date
            const now = new Date();
            const options = { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' };
            document.getElementById('submittedDate').textContent = now.toLocaleDateString('en-IN', options);

            // Clear CV extracted data from localStorage (form is complete)
            localStorage.removeItem('cvExtractedData');
        })();

        // Mini confetti burst
        (function () {
            const canvas = document.getElementById('confetti-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const colors = ['#003b5b', '#0461A3', '#16a34a', '#f59e0b', '#ec4899', '#8b5cf6', '#06b6d4'];
            const particles = [];
            const count = 120;

            for (let i = 0; i < count; i++) {
                particles.push({
                    x: canvas.width / 2 + (Math.random() - 0.5) * 200,
                    y: canvas.height / 2 - 100,
                    vx: (Math.random() - 0.5) * 12,
                    vy: Math.random() * -14 - 4,
                    w: Math.random() * 8 + 4,
                    h: Math.random() * 6 + 3,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    rotation: Math.random() * 360,
                    rotSpeed: (Math.random() - 0.5) * 10,
                    gravity: 0.25 + Math.random() * 0.15,
                    opacity: 1
                });
            }

            let frame = 0;
            const maxFrames = 180;

            function animate() {
                if (frame > maxFrames) {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    canvas.remove();
                    return;
                }
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                particles.forEach(p => {
                    p.x += p.vx;
                    p.vy += p.gravity;
                    p.y += p.vy;
                    p.vx *= 0.99;
                    p.rotation += p.rotSpeed;

                    if (frame > maxFrames - 60)
                        p.opacity = Math.max(0, p.opacity - 0.02);

                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate((p.rotation * Math.PI) / 180);
                    ctx.globalAlpha = p.opacity;
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
                    ctx.restore();
                });

                frame++;
                requestAnimationFrame(animate);
            }

            // Start confetti after a small delay so the page renders first
            setTimeout(animate, 400);
        })();
    </script>
}
